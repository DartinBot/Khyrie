<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitFriendsClubs Worker Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .test-card {
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #4CAF50;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .test-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        .test-card h3 {
            margin-top: 0;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .test-card p {
            opacity: 0.9;
            line-height: 1.6;
        }
        button {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
            min-width: 140px;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
        }
        button:active {
            transform: translateY(0);
        }
        .url-input {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
        }
        .results {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            line-height: 1.4;
        }
        .status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            margin: 5px;
        }
        .status.success { background: #4CAF50; color: white; }
        .status.error { background: #f44336; color: white; }
        .status.loading { background: #ff9800; color: white; }
        .status.info { background: #2196F3; color: white; }
        .emoji { font-size: 1.2em; }
        .config-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
            justify-content: center;
        }
        .endpoint-list {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        .endpoint-list h4 {
            margin: 0 0 10px 0;
            color: #4CAF50;
        }
        .endpoint-list ul {
            margin: 0;
            padding-left: 20px;
        }
        .endpoint-list li {
            margin: 5px 0;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><span class="emoji">üèãÔ∏è‚Äç‚ôÄÔ∏è</span> FitFriendsClubs Worker Test <span class="emoji">üöÄ</span></h1>
        
        <div class="config-section">
            <h3>Configuration</h3>
            <label for="workerUrl">Worker URL:</label>
            <input type="text" id="workerUrl" class="url-input" 
                   placeholder="https://your-worker-name.your-subdomain.workers.dev" 
                   value="">
            <p><strong>Instructions:</strong> Deploy your worker first, then paste the URL above to test it.</p>
        </div>

        <div class="quick-actions">
            <button onclick="testEndpoint('/')">üè† Health Check</button>
            <button onclick="testEndpoint('/test/database')">üíæ Test Database</button>
            <button onclick="testEndpoint('/test/clubs')">üèÉ‚Äç‚ôÄÔ∏è Test Clubs</button>
            <button onclick="testEndpoint('/test/trails')">üó∫Ô∏è Test Trails</button>
            <button onclick="testEndpoint('/test/all')">üß™ Run All Tests</button>
        </div>

        <div class="test-grid">
            <div class="test-card">
                <h3><span class="emoji">üåê</span> Health Check</h3>
                <p>Test basic worker connectivity and configuration.</p>
                <div class="endpoint-list">
                    <h4>Available Endpoints:</h4>
                    <ul>
                        <li><code>/</code> - Basic health check</li>
                        <li><code>/health</code> - Detailed health status</li>
                    </ul>
                </div>
                <button onclick="testEndpoint('/')">Test Health</button>
                <div id="health-results" class="results" style="display: none;"></div>
            </div>

            <div class="test-card">
                <h3><span class="emoji">üíæ</span> Database Connection</h3>
                <p>Verify Supabase database connectivity and access.</p>
                <button onclick="testEndpoint('/test/database')">Test Database</button>
                <div id="database-results" class="results" style="display: none;"></div>
            </div>

            <div class="test-card">
                <h3><span class="emoji">üèÉ‚Äç‚ôÄÔ∏è</span> Fitness Clubs</h3>
                <p>Test fitness clubs data retrieval from the database.</p>
                <button onclick="testEndpoint('/test/clubs')">Test Clubs</button>
                <div id="clubs-results" class="results" style="display: none;"></div>
            </div>

            <div class="test-card">
                <h3><span class="emoji">üó∫Ô∏è</span> Virtual Trails</h3>
                <p>Test virtual trails data and famous routes.</p>
                <button onclick="testEndpoint('/test/trails')">Test Trails</button>
                <div id="trails-results" class="results" style="display: none;"></div>
            </div>

            <div class="test-card">
                <h3><span class="emoji">üß™</span> Complete Test Suite</h3>
                <p>Run all tests and get a comprehensive report.</p>
                <button onclick="testEndpoint('/test/all')">Run All Tests</button>
                <div id="all-results" class="results" style="display: none;"></div>
            </div>

            <div class="test-card">
                <h3><span class="emoji">üîß</span> Custom Test</h3>
                <p>Test any custom endpoint:</p>
                <input type="text" id="customEndpoint" placeholder="/your/endpoint" style="width: 100%; margin: 10px 0; padding: 8px; border-radius: 4px; border: none;">
                <button onclick="testCustomEndpoint()">Test Custom</button>
                <div id="custom-results" class="results" style="display: none;"></div>
            </div>
        </div>

        <div class="config-section">
            <h3>Deployment Instructions</h3>
            <ol>
                <li><strong>Copy the worker code:</strong> Copy <code>simple-worker-test.js</code> content</li>
                <li><strong>Go to Cloudflare Dashboard:</strong> <a href="https://dash.cloudflare.com/" target="_blank" style="color: #4CAF50;">https://dash.cloudflare.com/</a></li>
                <li><strong>Navigate to Workers & Pages</strong></li>
                <li><strong>Create or update your worker</strong> with the test code</li>
                <li><strong>Deploy and get the URL</strong></li>
                <li><strong>Paste the URL above</strong> and start testing!</li>
            </ol>
        </div>
    </div>

    <script>
        // Set default URL if available
        document.addEventListener('DOMContentLoaded', function() {
            const urlInput = document.getElementById('workerUrl');
            // You can set a default URL here once you have your worker deployed
            // urlInput.value = 'https://fitfriendsclubs-api.your-subdomain.workers.dev';
        });

        async function testEndpoint(endpoint) {
            const baseUrl = document.getElementById('workerUrl').value.trim();
            
            if (!baseUrl) {
                alert('Please enter your Cloudflare Worker URL first!');
                return;
            }

            const resultsId = getResultsId(endpoint);
            const resultsDiv = document.getElementById(resultsId);
            
            // Show loading state
            resultsDiv.style.display = 'block';
            resultsDiv.textContent = 'Testing... ‚è≥';
            
            try {
                const fullUrl = baseUrl + endpoint;
                console.log('Testing URL:', fullUrl);
                
                const startTime = performance.now();
                const response = await fetch(fullUrl, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }
                });
                const endTime = performance.now();
                const responseTime = Math.round(endTime - startTime);
                
                const data = await response.json();
                
                const result = {
                    status: response.ok ? 'SUCCESS' : 'ERROR',
                    statusCode: response.status,
                    responseTime: responseTime + 'ms',
                    url: fullUrl,
                    timestamp: new Date().toISOString(),
                    data: data
                };
                
                resultsDiv.textContent = JSON.stringify(result, null, 2);
                
                // Add visual status indicator
                const statusClass = response.ok ? 'success' : 'error';
                const statusText = response.ok ? '‚úÖ SUCCESS' : '‚ùå ERROR';
                
                resultsDiv.innerHTML = `<span class="status ${statusClass}">${statusText}</span> ${responseTime}ms\n\n` + 
                                       JSON.stringify(result, null, 2);
                
            } catch (error) {
                console.error('Test failed:', error);
                resultsDiv.innerHTML = `<span class="status error">‚ùå NETWORK ERROR</span>\n\n` +
                                       `Error: ${error.message}\n` +
                                       `URL: ${baseUrl + endpoint}\n` +
                                       `Time: ${new Date().toISOString()}`;
            }
        }

        async function testCustomEndpoint() {
            const endpoint = document.getElementById('customEndpoint').value.trim();
            if (!endpoint) {
                alert('Please enter a custom endpoint to test!');
                return;
            }
            
            if (!endpoint.startsWith('/')) {
                document.getElementById('customEndpoint').value = '/' + endpoint;
            }
            
            await testEndpoint(document.getElementById('customEndpoint').value);
        }

        function getResultsId(endpoint) {
            const mapping = {
                '/': 'health-results',
                '/health': 'health-results',
                '/test/database': 'database-results',
                '/test/clubs': 'clubs-results', 
                '/test/trails': 'trails-results',
                '/test/all': 'all-results'
            };
            
            return mapping[endpoint] || 'custom-results';
        }

        // Add keyboard support for custom endpoint
        document.getElementById('customEndpoint').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                testCustomEndpoint();
            }
        });

        // Add keyboard support for URL input
        document.getElementById('workerUrl').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                testEndpoint('/');
            }
        });
    </script>
</body>
</html>